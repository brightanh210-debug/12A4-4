<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <title>Trang cá nhân</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="profile-container">
    <img src="flower.png" alt="decor" class="profile-decor" />
    <h1 id="pname">Tên bạn</h1>
    <p id="details">Lớp 12A4 &nbsp;•&nbsp; THPT Lê Quý Đôn</p>
    <p id="nickname">Biệt danh: -</p>
    <div class="poem-box" id="poem">
      <em>Đây là khung để đặt bài thơ tặng bạn. Sửa nội dung trong file profile.html theo từng người hoặc quản lý bằng JavaScript.</em>
    </div>
    <div class="profile-actions">
      <button id="copyLink">Sao chép link trang này</button>
      <button id="homeBtn">Quay về trang chủ</button>
    </div>
    <img src="butterflies.png" alt="butterflies" class="profile-butter" />
  </div>

<script>
// Lấy tên từ query param 'user' hoặc localStorage
function getQuery(name){
  const params = new URLSearchParams(window.location.search);
  return params.get(name);
}
let slug = getQuery('user') || localStorage.getItem('currentSlug') || 'user';
let raw = localStorage.getItem('currentUser') || slug.replace(/-/g,' ');
document.getElementById('pname').textContent = raw;
document.getElementById('nickname').textContent = 'Biệt danh: ' + (localStorage.getItem('nickname') || '-');
document.getElementById('poem').innerHTML = localStorage.getItem('poem') || '<em>Bài thơ tặng bạn sẽ nằm ở đây.</em>';

document.getElementById('copyLink').addEventListener('click', function(){
  const u = window.location.href;
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(u).then(()=> alert('Đã sao chép link!'));
  } else {
    const tmp = document.createElement('input');
    document.body.appendChild(tmp);
    tmp.value=u; tmp.select(); document.execCommand('copy'); document.body.removeChild(tmp);
    alert('Đã sao chép link!');
  }
});

document.getElementById('homeBtn').addEventListener('click', function(){
  window.location.href = 'index.html';
});
</script>
</body>
</html>
